function SpritePlayer(e){function t(){void 0===s&&function(e){C.complete&&void 0!==C.naturalWidth&&0!=C.naturalWidth?e():(C.addEventListener("load",function(){e()}),C.src=h)}(function(){u.dispatchEvent(o),"repaint"==m?(I.tick=0,n()):"fps"==m&&(I.fpsInterval=1e3/f,I.fpsThen=window.performance.now(),I.fpsStartTime=I.fpsThen,i())})}function n(){s=window.requestAnimationFrame(n),0===I.tick&&(r(),a()),I.tick+=1,I.tick>f&&(I.tick=0)}function i(e){s=window.requestAnimationFrame(i),I.fpsNow=e,I.fpsElapsed=I.fpsNow-I.fpsThen,I.fpsElapsed>I.fpsInterval&&(I.fpsThen=I.fpsNow-I.fpsElapsed%I.fpsInterval,r(),a())}function r(){y.clearRect(0,0,E,w),y.drawImage(C,k.currentFrame%g*E,Math.floor(k.currentFrame/g)*w,E,w,0,0,E,w),u.currentFrame=k.currentFrame,u.dispatchEvent(d)}function a(){k.currentFrame<l-1?k.currentFrame+=1:F?k.currentFrame=0:(window.cancelAnimationFrame(s),s=void 0,u.dispatchEvent(c))}var o,c,d,p,s,v=void 0!==e.autoPlay&&e.autoPlay,u=e.canvas,f=void 0!==e.drawClock?e.drawClock:0,m=void 0!==e.drawUnit?e.drawUnit:"repaint",l=void 0!==e.frameCount?e.frameCount:0,w=void 0!==e.frameHeight?e.frameHeight:0,E=void 0!==e.frameWidth?e.frameWidth:0,h=void 0!==e.imgSrc?e.imgSrc:"",F=void 0!==e.loop&&e.loop,g=void 0!==e.spritesPerRow?e.spritesPerRow:l,k={currentFrame:0},y=u.getContext("2d"),C=new Image,I={};return k.play=function(){t()},k.pause=function(){void 0!==s&&(window.cancelAnimationFrame(s),s=void 0,u.dispatchEvent(p))},(o=document.createEvent("Event")).initEvent("spriteplay",!0,!0),(c=document.createEvent("Event")).initEvent("spriteended",!0,!0),(d=document.createEvent("Event")).initEvent("spritetimeupdate",!0,!0),(p=document.createEvent("Event")).initEvent("spritepause",!0,!0),u.height=w,u.width=E,v&&t(),k}